_M={}function _M.parse_image_sprite_block(a,b)if string.byte(a,1)==0xFF then local c={}c.width=string.byte(a,2)<<8|string.byte(a,3)c.height=string.byte(a,4)<<8|string.byte(a,5)c.sprite_line_height=string.byte(a,6)<<8|string.byte(a,7)c.progressive_render=string.byte(a,8)==1;c.updatable=string.byte(a,9)==1;c.sprites={}local d=c.height+c.sprite_line_height-1;c.total_sprites=d//c.sprite_line_height;c.active_sprites=0;c.current_sprite_index=0;return c else if b==nil then return nil end;b.current_sprite_index=b.current_sprite_index+1;if b.current_sprite_index>b.total_sprites then if b.updatable then b.current_sprite_index=1 else return b end end;if b.active_sprites<b.total_sprites then b.active_sprites=b.active_sprites+1 end;local e={}e.width=string.byte(a,1)<<8|string.byte(a,2)e.height=string.byte(a,3)<<8|string.byte(a,4)e.bpp=string.byte(a,5)e.num_colors=string.byte(a,6)e.palette_data=string.sub(a,7,7+e.num_colors*3-1)e.pixel_data=string.sub(a,7+e.num_colors*3)b.sprites[b.current_sprite_index]=e;return b end end;return _M